<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel</title>
  <link rel="stylesheet" href="/static/css/site.css" />
  <link rel="stylesheet" href="/static/css/admin.css" />
</head>
<body>
  <header class="header">
    <div class="header-container">
      <div class="header-left">
        <a href="/services">
          <img src="/static/img/Logo.png" class="logo" alt="Logo" />
        </a>
      </div>
      <nav class="header-nav">
        <a href="/services">Services</a>
        <a href="/about">About Us</a>
        <a href="/contact">Contact</a>
      </nav>
      <div class="header-right">
        <a class="btn btn-outline" href="/auth/logout">Logout</a>
      </div>
    </div>
  </header>

  <div class="container">
    <section class="admin-panel">
      <div class="controls">
        <button class="active" data-view="day">Day</button>
        <button data-view="week">Week</button>
        <button data-view="month">Month</button>
      </div>

      <!-- DAY VIEW -->
      <div class="view day-view active">
        <div class="time-column">
          <script>
            for (let hour = 9; hour <= 19; hour++) {
              document.write(`<div class="time-slot">${hour}:00</div>`);
            }
          </script>
        </div>

        <div class="appointments-column">
          <h2 style="margin:0 0 10px 0">Bookings for {{ date }}</h2>

          {% if bookings and bookings|length %}
            <div class="bookings-list">
              {% for b in bookings %}
                <div class="booking-card">
                  <div class="booking-time">
                    {{ (b["start_time"] or "")[11:16] }} - {{ (b["end_time"] or "")[11:16] }}
                  </div>
                  <div class="booking-main">
                    <div class="booking-title">
                      {{ b.get("service_name") or ("Service #" ~ b.get("service_id")) }}
                      {% if b.get("barber_name") %} • {{ b.get("barber_name") }}{% endif %}
                    </div>
                    <div class="booking-sub">
                      {{ b.get("customer_name") or "Customer" }}
                      {% if b.get("status") %} • {{ b.get("status") }}{% endif %}
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <p class="muted">No bookings for this day.</p>
          {% endif %}

          <hr style="margin:18px 0" />

          <h3 style="margin:0 0 10px 0">Create booking</h3>
          {% if error %}
            <p class="error">{{ error }}</p>
          {% endif %}

          <form class="booking-form" method="post" action="/admin/book">
            <div class="grid">
              <div>
                <label>Customer name</label>
                <input name="customer_name" required />
              </div>

              <div>
                <label>Customer phone (optional)</label>
                <input name="customer_phone" />
              </div>

              <div>
                <label>Customer email (optional)</label>
                <input name="customer_email" type="email" />
              </div>

              <div>
                <label>Service ID</label>
                <input name="service_id" type="number" min="1" required />
              </div>

              <div>
                <label>Barber ID (optional)</label>
                <input name="barber_id" type="number" min="1" />
              </div>

              <div>
                <label>Date</label>
                <input name="date" type="date" value="{{ date }}" required />
              </div>

              <div>
                <label>Time</label>
                <input name="time" type="time" required />
              </div>
            </div>

            <button class="btn" type="submit" style="margin-top:10px">Create</button>
          </form>
        </div>
      </div>

      <!-- WEEK VIEW (static UI only) -->
      <div class="view week-view">
        <h2>Week View</h2>
        <div class="week-grid">
          <div class="day-col">Mon</div>
          <div class="day-col">Tue</div>
          <div class="day-col">Wed</div>
          <div class="day-col">Thu</div>
          <div class="day-col">Fri</div>
          <div class="day-col">Sat</div>
          <div class="day-col">Sun</div>
        </div>
      </div>

      <!-- MONTH VIEW (static UI only) -->
      <div class="view month-view">
        <h2>Month View</h2>
        <div class="month-grid">
          <script>
            for (let i = 1; i <= 30; i++) {
              document.write(`<div class="date-cell">${i}<div class="dot"></div></div>`);
            }
          </script>
        </div>
      </div>
    </section>
  </div>

  <footer class="footer">
    <div class="footer-container">
      <div class="footer-left">
        <img src="/static/img/Logo.png" class="logo" alt="Logo" />
        <p class="footer-copy">Copyright</p>
      </div>
    </div>
  </footer>

  <script>
    const buttons = document.querySelectorAll(".controls button[data-view]");
    const views = document.querySelectorAll(".view");

    buttons.forEach((btn) => {
      btn.addEventListener("click", () => {
        buttons.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");

        const viewName = btn.dataset.view;
        views.forEach((v) => v.classList.remove("active"));
        document.querySelector(`.${viewName}-view`).classList.add("active");
      });
    });
  </script>
</body>
</html>
