{% extends "base.html" %}
{% block title %}{{ "Edit" if appt else "New" }} Appointment{% endblock %}
{% block content %}

<h2>{{ "Edit" if appt else "New" }} appointment</h2>

{% if error %}
<div class="alert error" role="alert">{{ error }}</div>
{% endif %}

<form method="post">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

  <label for="service_id">Service</label>
  <select id="service_id" name="service_id" required>
    <option value="">Select service</option>
    {% for s in services %}
      <option value="{{ s.id }}"
        {% if appt and (appt.get('service_id')|int) == (s.id|int) %}selected{% endif %}>
        {{ s.name }}
      </option>
    {% endfor %}
  </select>

  <label for="date">Date</label>
  <input id="date" type="date" name="date" required
         value="{{ appt.get('date', '') if appt else '' }}"
         min="{{ today|default('') }}">

  <label for="time">Time</label>
  <input id="time" type="time" name="time" required
         value="{{ appt.get('time', '') if appt else '' }}"
         min="{{ open_time|default('11:00') }}" max="{{ close_time|default('19:00') }}" step="60">

  <button type="submit" class="btn primary">{{ "Save" if appt else "Create" }}</button>
  <a class="btn btn-secondary" href="{{ url_for('appointments.list_appointments') }}">Cancel</a>
</form>

{% endblock %}
