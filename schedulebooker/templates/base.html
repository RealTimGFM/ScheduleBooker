<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}ScheduleBooker{% endblock %}</title>

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap"
    rel="stylesheet">

  <!-- Site styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/site.css') }}">

  {% block head %}{% endblock %}
</head>

<body>
  <nav class="navbar">
    <div class="navdiv">
      <a href="{{ url_for('public.services') }}" aria-label="Home" style="display:flex; align-items:center; gap:10px;">
        <img class="logo" src="{{ url_for('static', filename='img/Logo.png') }}" alt="Logo"
          onerror="this.style.display='none'; document.getElementById('logo-fallback').style.display='block';">
        <span id="logo-fallback" style="display:none; color: var(--gold-warm); font-weight: 800; letter-spacing: 1px;">
          LOGO
        </span>
      </a>

      {% if session.get("admin_user_id") %}
      <!-- ADMIN NAV -->
      <ul class="nav-menu">
        <li><a href="/admin/services">Services</a></li>
        <li><a href="/admin/barbers">Barber</a></li>
        <li><a href="{{ url_for('admin.day') }}">Calendar</a></li>
      </ul>

      <div class="nav-auth">
        <a class="nav-link" href="{{ url_for('admin.logout') }}">Admin logout</a>

        <button class="theme-toggle icon-only" id="theme-toggle" type="button" aria-label="Toggle theme"
          title="Toggle theme">
          ðŸŒ“
        </button>
      </div>


      {% else %}
      <!-- CUSTOMER NAV -->
      <ul class="nav-menu">
        <li><a href="{{ url_for('public.services') }}">Home</a></li>
        <li><a href="{{ url_for('public.services') }}#services">Service</a></li>

        <!-- Keep your working URLs (no BuildError risk) -->
        <li><a href="/about">About Us</a></li>
        <li><a href="/contact">Contact</a></li>

        <!-- Admin now shares exact same structure/CSS as the other nav items -->
        <li><a href="{{ url_for('admin.home') }}">Admin</a></li>

        {% if session.get("user_id") %}
        <li><a href="{{ url_for('appointments.list_appointments') }}">My Appointments</a></li>
        {% endif %}
      </ul>

      <div class="nav-auth">
        {% if session.get("user_id") %}
        <a class="nav-link" href="{{ url_for('appointments.list_appointments') }}">My appointments</a>
        <a class="nav-link" href="{{ url_for('auth.logout') }}">Logout</a>
        {% else %}
        <a class="nav-link" href="{{ url_for('auth.signup') }}">Sign up</a>
        <a class="nav-link" href="{{ url_for('auth.login') }}">Login</a>
        {% endif %}

        <button class="theme-toggle icon-only" id="theme-toggle" type="button" aria-label="Toggle theme"
          title="Toggle theme">
          ðŸŒ“
        </button>
      </div>
      {% endif %}
    </div>
  </nav>

  <main>
    {% if error %}
    <div class="alert" role="alert"><strong>Note:</strong> {{ error }}</div>
    {% endif %}

    {% block content %}{% endblock %}
  </main>

  <footer class="footer" id="footer">
    <div class="footer-container">
      <div>
        <h4>ScheduleBooker</h4>
        <p class="footer-copy">Simple booking flow for a small shop.</p>
      </div>
      <div>
        <h4>Links</h4>
        <p class="footer-copy"><a href="{{ url_for('public.services') }}">Services</a></p>
        <p class="footer-copy"><a href="{{ url_for('public.find_booking_page') }}">Find booking</a></p>
      </div>
      <div>
        <h4>Hours</h4>
        <p class="footer-copy">Tuesdayâ€“Sunday: 11:00â€“19:00</p>
        <p class="footer-copy">Closed Monday</p>
      </div>
    </div>
  </footer>

  <script>
    // Theme toggle (persists in localStorage) - icon only
    (function () {
      const key = "sb_theme";
      const saved = localStorage.getItem(key);
      if (saved === "dark") document.body.setAttribute("data-theme", "dark");

      const btn = document.getElementById("theme-toggle");
      if (!btn) return;

      btn.addEventListener("click", function () {
        const isDark = document.body.getAttribute("data-theme") === "dark";
        if (isDark) {
          document.body.removeAttribute("data-theme");
          localStorage.setItem(key, "light");
          btn.setAttribute("title", "Switch to dark mode");
        } else {
          document.body.setAttribute("data-theme", "dark");
          localStorage.setItem(key, "dark");
          btn.setAttribute("title", "Switch to light mode");
        }
      });
    })();
  </script>


  {% block scripts %}{% endblock %}
</body>

</html>