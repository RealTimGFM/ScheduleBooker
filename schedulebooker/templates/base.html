<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="csrf-token" content="{{ csrf_token() }}">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Sonthien Coiffure{% endblock %}</title>


  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap"
    rel="stylesheet">

  <!-- Site styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/site.css') }}">

  {% block head %}{% endblock %}
</head>

<body>
  <nav class="navbar">
    <div class="navdiv">
      <a href="{{ url_for('public.services') }}" aria-label="Home" style="display:flex; align-items:center; gap:10px;">
        <img class="logo" src="{{ url_for('static', filename='img/logo.png') }}" alt="Sonthien Coiffure logo"
          onerror="this.style.display='none'; document.getElementById('logo-fallback').style.display='block';">
        <span id="logo-fallback" style="display:none; color: var(--gold-warm); font-weight: 800; letter-spacing: 1px;">
          Sonthien Coiffure
        </span>
      </a>

      {% if session.get("admin_user_id") %}
      <!-- ADMIN NAV -->
      <ul class="nav-menu">
        <li><a href="/admin/services">Services</a></li>
        <li><a href="/admin/barbers">Barber</a></li>
        <li><a href="{{ url_for('admin.day') }}">Calendar</a></li>
      </ul>

      <div class="nav-auth">
        <a class="nav-link nav-settings-icon" href="{{ url_for('admin.settings') }}" title="Settings">‚öôÔ∏è</a>
        <a class="nav-link" href="{{ url_for('admin.logout') }}">Admin logout</a>

        <button class="theme-toggle icon-only" id="theme-toggle" type="button" aria-label="Toggle theme"
          title="Toggle theme">
          üåì
        </button>
      </div>


      {% else %}
      <!-- CUSTOMER NAV -->
      <ul class="nav-menu">
        <li><a href="{{ url_for('public.services') }}">Home</a></li>
        <li><a href="{{ url_for('public.services') }}#services">Service</a></li>
        <li><a href="/about">About Us</a></li>
        <li><a href="/contact">Contact</a></li>

        {% if session.get("user_id") %}
        <li><a href="{{ url_for('appointments.list_appointments') }}">My Appointments</a></li>
        {% else %}
        <li><a href="{{ url_for('admin.home') }}">Admin</a></li>
        {% endif %}
      </ul>

      <div class="nav-auth">
        {% if session.get("user_id") %}
        <a class="nav-link" href="{{ url_for('auth.logout') }}">Logout</a>
        {% else %}
        <a class="nav-link" href="{{ url_for('auth.signup') }}">Sign up</a>
        <a class="nav-link" href="{{ url_for('auth.login') }}">Login</a>
        {% endif %}

        <button class="theme-toggle icon-only" id="theme-toggle" type="button" aria-label="Toggle theme"
          title="Toggle theme">
          üåì
        </button>
      </div>
      {% endif %}
    </div>
  </nav>

  <main>
    {# Existing inline error support #}
    {% if error %}
    <div class="alert alert-error" role="alert"><strong>Note:</strong> {{ error }}</div>
    {% endif %}

    {# Flash messages (success/fail) #}
    {% with messages = get_flashed_messages(with_categories=True) %}
    {% if messages %}
    {% for category, message in messages %}
    {% if category == "success" %}
    <div class="alert alert-success" role="alert">{{ message }}</div>
    {% else %}
    <div class="alert alert-error" role="alert">{{ message }}</div>
    {% endif %}
    {% endfor %}
    {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </main>


  <footer class="footer" id="footer">
    <div class="footer-container">
      <div>
        <h4>Sonthien Coiffure</h4>
        <p class="footer-copy">Salon de coiffure ¬∑ Montr√©al (Petite Italie)</p>
        <p class="footer-copy">
          <a href="tel:+15142773585">(514) 277-3585</a>
        </p>

        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2794.7845658117!2d-73.61924242372218!3d45.53454067107514!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x4cc91912fc6b9e75%3A0x7df6d5f6eb9e0ada!2s29%20Av.%20Shamrock%2C%20Montr%C3%A9al%2C%20QC%20H2S%201A3!5e0!3m2!1sen!2sca!4v1767733997214!5m2!1sen!2sca"
          width="600" height="200" style="border:0;" allowfullscreen="" loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"></iframe>

      </div>

      <div>
        <h4>Links</h4>
        <p class="footer-copy"><a href="{{ url_for('public.services') }}">Services</a></p>
        <p class="footer-copy"><a href="/about">About</a></p>
        <p class="footer-copy"><a href="/contact">Contact</a></p>
        <p class="footer-copy"><a href="{{ url_for('public.find_booking_page') }}">Find / Cancel booking</a></p>
      </div>

      <div>
        <h4>Hours</h4>
        <p class="footer-copy">Tuesday‚ÄìSunday: 11:00‚Äì19:00</p>
        <p class="footer-copy">Closed Monday</p>
        <p class="footer-copy" style="opacity:.9">Hours may vary‚Äîcall to confirm.</p>
      </div>
    </div>
  </footer>


  <script>
    // Theme toggle (persists in localStorage) - icon only
    (function () {
      const key = "sb_theme";
      const saved = localStorage.getItem(key);
      if (saved === "dark") document.body.setAttribute("data-theme", "dark");

      const btn = document.getElementById("theme-toggle");
      if (!btn) return;

      btn.addEventListener("click", function () {
        const isDark = document.body.getAttribute("data-theme") === "dark";
        if (isDark) {
          document.body.removeAttribute("data-theme");
          localStorage.setItem(key, "light");
          btn.setAttribute("title", "Switch to dark mode");
        } else {
          document.body.setAttribute("data-theme", "dark");
          localStorage.setItem(key, "dark");
          btn.setAttribute("title", "Switch to light mode");
        }
      });
    })();
  </script>


  {% block scripts %}{% endblock %}
</body>

</html>